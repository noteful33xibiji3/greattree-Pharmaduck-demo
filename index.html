<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pharma.Duck æ™ºæ…§è—¥å¸«åŠ©ç† (æ±ºè³½æ¼”ç¤ºç‰ˆ)</title>
    <style>
        /* === 1. å¤§æ¨¹è—¥å±€è¦–è¦ºé¢¨æ ¼ === */
        :root { --gt-green: #009944; --gt-orange: #F39800; --bg-gray: #f5f5f5; }
        body { font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", sans-serif; background-color: var(--bg-gray); margin: 0; padding-bottom: 50px; }
        
        /* Header */
        header { background: white; padding: 15px 0; border-bottom: 4px solid var(--gt-green); box-shadow: 0 2px 10px rgba(0,0,0,0.1); sticky: top; }
        .nav-container { max-width: 1200px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; }
        .logo img { height: 50px; } 

        /* å•†å“å€ */
        .main-content { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        .section-title { border-left: 5px solid var(--gt-orange); padding-left: 15px; font-size: 24px; color: #333; margin-bottom: 20px; font-weight: bold; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
        
        /* å•†å“å¡ç‰‡ */
        .product-card { background: white; padding: 15px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); position: relative; transition: transform 0.2s; border: 2px solid transparent; }
        .product-card:hover { transform: translateY(-5px); border-color: var(--gt-green); }
        .tag { position: absolute; top: 10px; right: 10px; color: white; padding: 4px 10px; font-size: 12px; border-radius: 20px; font-weight: bold; }
        .tag.drug { background: #d0021b; } /* è—¥å“ç´…æ¨™ */
        .tag.food { background: var(--gt-green); } /* é£Ÿå“ç¶ æ¨™ */
        
        .p-img { width: 100%; height: 160px; object-fit: contain; margin-bottom: 15px; }
        .p-name { font-weight: bold; font-size: 16px; margin-bottom: 8px; line-height: 1.4; height: 44px; overflow: hidden; }
        .p-price { color: #d0021b; font-weight: bold; font-size: 20px; }

        /* === 2. é´¨å­åŠ©ç† (UIæ ¸å¿ƒ) === */
        .duck-fab { position: fixed; bottom: 20px; right: 20px; width: 180px; cursor: pointer; z-index: 2000; transition: transform 0.3s; }
        .duck-fab:hover { transform: scale(1.05) translateY(-10px); }
        .duck-fab img { width: 100%; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.2)); }
        
        /* èŠå¤©è¦–çª— */
        .chat-window {
            position: fixed; bottom: 20px; right: 220px; width: 380px; height: 600px;
            background: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: none; flex-direction: column; overflow: hidden; z-index: 2001; border: 1px solid #ddd;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .chat-header { background: var(--gt-green); color: white; padding: 15px; display: flex; align-items: center; font-size: 18px; font-weight: bold; }
        .chat-body { flex: 1; padding: 20px; overflow-y: auto; background: #f0fdf4; scroll-behavior: smooth; }
        
        /* å°è©±æ°£æ³¡ */
        .msg { margin-bottom: 20px; clear: both; }
        .msg-duck { float: left; width: 100%; }
        .msg-duck .bubble { background: white; padding: 15px; border-radius: 20px 20px 20px 5px; border: 1px solid #e5e7eb; box-shadow: 0 2px 5px rgba(0,0,0,0.05); max-width: 85%; float: left; position: relative; }
        .msg-user { float: right; width: 100%; }
        .msg-user .bubble { background: var(--gt-green); color: white; padding: 12px 18px; border-radius: 20px 20px 5px 20px; max-width: 80%; float: right; }

        /* ç‰¹æ®Šå¡ç‰‡æ¨£å¼ (åœ°åœ–ã€è­¦å‘Šã€æ¢—åœ–) */
        .card-insert { margin-top: 10px; border-radius: 12px; overflow: hidden; border: 1px solid #eee; }
        .card-insert img { width: 100%; display: block; }
        .warning-box { background: #fff5f5; border-left: 5px solid #fc8181; padding: 10px; margin-top: 10px; font-size: 14px; color: #c53030; }
        .action-btn { display: block; width: 100%; padding: 12px; text-align: center; color: white; font-weight: bold; text-decoration: none; margin-top: 10px; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .btn-store { background: var(--gt-orange); } /* é–€å¸‚æŒ‰éˆ• */
        .btn-online { background: var(--gt-green); } /* ç·šä¸Šè³¼è²·æŒ‰éˆ• */

        /* è¼¸å…¥å€ */
        .chat-input { padding: 15px; border-top: 1px solid #eee; display: flex; background: white; gap: 10px; }
        .chat-input input { flex: 1; padding: 12px; border-radius: 25px; border: 2px solid #ddd; outline: none; font-size: 16px; }
        .chat-input input:focus { border-color: var(--gt-green); }
        .chat-input button { background: var(--gt-orange); color: white; border: none; width: 50px; height: 50px; border-radius: 50%; cursor: pointer; font-size: 20px; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

        /* === 3. é»æ•¸å‡ç´šå‹•ç•« (Gamification) === */
        .level-popup {
            position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.85); color: #FFD700; padding: 30px; border-radius: 20px;
            text-align: center; display: none; z-index: 3000; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn { from { transform: translate(-50%, -50%) scale(0.5); opacity: 0; } to { transform: translate(-50%, -50%) scale(1); opacity: 1; } }

        /* Footer */
        footer { background: #333; color: white; text-align: center; padding: 40px 0; margin-top: 50px; }
    </style>
</head>
<body>

<header>
    <div class="nav-container">
        <div class="logo">
            <img src="images/logo.png" alt="å¤§æ¨¹è—¥å±€ Logo" onerror="this.style.display='none'; this.parentNode.innerText='ğŸŒ³ å¤§æ¨¹å¥åº·è³¼ç‰©ç¶² (Demo)';">
        </div>
        <div style="font-size: 14px; color: #666; font-weight: bold;">
            ğŸ§ª è—¥å­¸ç³»å°ˆé¡Œï¼šPharma.Duck æ™ºæ…§å°è³¼ç³»çµ±
        </div>
    </div>
</header>

<div class="main-content">
    <div class="section-title">æœ¬å­£ç†±éŠ·ï¼šå¥åº·ä¿å¥å°ˆå€</div>
    <div class="product-grid" id="productGrid">
        </div>
</div>

<div class="duck-fab" onclick="toggleChat()">
    <img src="images/my_duck.png" alt="Ph.D é´¨é´¨" onerror="this.src='https://placehold.co/200x200/F39800/white?text=Duck+PhD'">
    <div style="position: absolute; bottom: -25px; left: 50%; transform: translateX(-50%); background: #333; color: #fff; padding: 2px 10px; border-radius: 10px; font-size: 12px; white-space: nowrap;">
        é»æˆ‘è«®è©¢è—¥å¸«
    </div>
</div>

<div class="chat-window" id="chatWindow">
    <div class="chat-header">
        <img src="images/my_duck.png" style="width: 35px; height: 35px; border-radius: 50%; background: white; margin-right: 10px; border: 2px solid white;">
        <div>Ph.D é´¨å­è—¥å¸« (ç·šä¸Š)</div>
        <div style="margin-left: auto; cursor: pointer; font-size: 24px;" onclick="toggleChat()">Ã—</div>
    </div>
    
    <div class="chat-body" id="chatBody">
        <div class="msg msg-duck">
            <div class="bubble">
                å‘±ï¼æˆ‘æ˜¯æ‚¨çš„å¤§æ¨¹å¥åº·é¡§å• Ph.D é´¨é´¨ã€‚ğŸ¦†<br><br>
                ä¸è«–æ˜¯<b>èº«é«”ä¸é©</b>éœ€è¦æª¢å‚·ï¼Œæˆ–æ˜¯æƒ³æ¯”è¼ƒ<b>ä¿å¥é£Ÿå“</b>ï¼Œéƒ½å¯ä»¥å•æˆ‘å–”ï¼<br><br>
                (æ¼”ç·´æŒ‡ä»¤ï¼šè©¦è‘—è¼¸å…¥ã€Œ<b>é ­ç—›</b>ã€æˆ–ã€Œ<b>Bç¾¤</b>ã€)
            </div>
        </div>
    </div>

    <div class="chat-input">
        <input type="text" id="userInput" placeholder="è«‹è¼¸å…¥ç—‡ç‹€æˆ–å•†å“å..." onkeypress="handleKeyPress(event)">
        <button onclick="sendMessage()">â¤</button>
    </div>
</div>

<div class="level-popup" id="levelUpModal">
    <div style="font-size: 50px;">ğŸ‰</div>
    <h2 style="margin: 10px 0;">æ­å–œå‡ç´šï¼</h2>
    <p>ç²å¾—å¤§æ¨¹å¹£ <b>+20</b></p>
    <p style="font-size: 14px; color: #ddd;">ç›®å‰ç­‰ç´šï¼šå¯¦ç¿’è—¥å¸«é´¨ (Lv.2)</p>
</div>

<footer>
    <div style="font-size: 18px; font-weight: bold; color: var(--gt-orange); margin-bottom: 10px;">åœ˜éšŠï¼šä¸€é´¨treeåƒ ğŸ¦†</div>
    <div>å˜‰å—è—¥ç†å¤§å­¸ è—¥å­¸ç³» | ç¬¬ä¸‰å±†å¤§æ¨¹è—¥å±€å‰µæ„ç«¶è³½</div>
    <div style="font-size: 12px; color: #888; margin-top: 15px;">
        æœ¬ç¶²é  IP å½¢è±¡èˆ‡å…§å®¹åƒ…ä¾›ç«¶è³½å±•ç¤ºä½¿ç”¨ï¼ŒéçœŸå¯¦ç‡Ÿé‹ç¶²ç«™ã€‚<br>
        Copyright Â© 2026 Pharma.Duck. All rights reserved.
    </div>
</footer>

<script>
    // === 1. è³‡æ–™åº«è¨­å®š (åˆ†æµï¼šè—¥å“Drug vs é£Ÿå“Food) ===
    const products = [
        // è—¥å“ (åªèƒ½ç·šä¸‹è²·ï¼Œæœ‰å‰¯ä½œç”¨)
        { id: 1, name: "æ™®æ‹¿ç–¼ æ­¢ç—›éŒ  (ä¹™é†¯èƒºé…š)", price: 150, type: "drug", image: "images/p_panadol.jpg", precautions: "24å°æ™‚å…§ä¸å¯è¶…é4é¡†ï¼Œé¿å…é£²é…’ï¼Œå‚·èƒƒè€…è«‹é£¯å¾Œæœç”¨ã€‚" },
        { id: 2, name: "åˆåˆ©ä»–å‘½ Ex Plus", price: 1800, type: "drug", image: "images/p_explus.jpg", precautions: "å±¬é†«å¸«è—¥å¸«æŒ‡ç¤ºç”¨è—¥ï¼Œä¾ç—‡ç‹€æœç”¨ã€‚" },
        // ä¿å¥å“ (å¯ç·šä¸Šè²·ï¼ŒOMOå°æµ)
        { id: 3, name: "å¤§æ¨¹ Bç¾¤+éµ (å¢å¼·é«”åŠ›)", price: 600, type: "food", image: "images/p_b_complex.jpg" },
        { id: 4, name: "èŠèƒç¾ ç¶œåˆç¶­ä»–å‘½", price: 850, type: "food", image: "images/p_multi_vit.jpg" },
        { id: 5, name: "ä¸‰å¾—åˆ© èŠéº»æ˜E (åŠ©çœ )", price: 1600, type: "food", image: "images/p_sesame.jpg" },
        { id: 6, name: "æŒºç«‹ UC-II (é—œéµä¿é¤Š)", price: 1580, type: "food", image: "images/p_ucii.jpg" }
    ];

    // åˆå§‹åŒ–å•†å“åˆ—è¡¨
    const grid = document.getElementById('productGrid');
    products.forEach(p => {
        // å¦‚æœæ²’æœ‰åœ–ç‰‡ï¼Œç”¨ç·šä¸Šå‡åœ–ä»£æ›¿ï¼Œä¿è­‰ä¸ç ´åœ–
        const fallbackImg = `https://placehold.co/300x200/${p.type==='drug'?'ffebee':'e8f5e9'}/333?text=${encodeURIComponent(p.name)}`;
        
        grid.innerHTML += `
            <div class="product-card">
                <div class="tag ${p.type}">${p.type==='drug' ? 'é–€å¸‚é™å®šè—¥å“' : 'ç·šä¸Šå¯è³¼é£Ÿå“'}</div>
                <img class="p-img" src="${p.image}" onerror="this.src='${fallbackImg}'">
                <div class="p-name">${p.name}</div>
                <div class="p-price">$${p.price}</div>
            </div>`;
    });

    // === 2. é´¨å­å¤§è…¦ (è…³æœ¬æ¼”ç®—æ³• Scripted Algorithm) ===
    let chatStep = 0; // 0:é–’ç½®, 1:æª¢å‚·ä¸­(å•å€‹è³‡), 2:æª¢å‚·ä¸­(å•éæ•)
    
    function toggleChat() {
        const win = document.getElementById('chatWindow');
        win.style.display = win.style.display === 'flex' ? 'none' : 'flex';
        if(win.style.display === 'flex') document.getElementById('userInput').focus();
    }
    
    function handleKeyPress(e) { if(e.key === 'Enter') sendMessage(); }

    function sendMessage() {
        const input = document.getElementById('userInput');
        const text = input.value.trim();
        if(!text) return;

        addMsg(text, 'user');
        input.value = '';

        // æ¨¡æ“¬ AI æ€è€ƒå»¶é² (0.8ç§’)
        setTimeout(() => {
            duckResponse(text);
        }, 800);
    }

    function duckResponse(text) {
        // --- åŠ‡æœ¬ Aï¼šé ­ç—›æª¢å‚· (Triage Flow) ---
        if (chatStep === 0 && (text.includes("é ­ç—›") || text.includes("ç—›"))) {
            addMsg("æ”¶åˆ°ï¼Œé—œæ–¼ç–¼ç—›å•é¡Œï¼Œç‚ºäº†æ‚¨çš„ç”¨è—¥å®‰å…¨ï¼Œé´¨é´¨éœ€è¦é€²è¡Œç°¡å–®çš„æª¢å‚·ã€‚ğŸ¦†ğŸ“‹<br><br>è«‹å•ä½¿ç”¨è€…çš„ï¼š<br>1. <b>å¹´é½¡</b><br>2. <b>é«”é‡</b> (å°æœ‹å‹éœ€è¨ˆç®—åŠ‘é‡)<br>3. <b>æ€§åˆ¥</b>", 'duck');
            chatStep = 1; // é€²å…¥ä¸‹ä¸€éšæ®µ
        }
        
        else if (chatStep === 1) {
            // åˆ¤æ–·æ˜¯å¦ç‚ºå…’ç«¥
            if (text.includes("æ­²") && parseInt(text) < 12) {
                addMsg("âš ï¸ <b>æ³¨æ„ï¼šå°æœ‹å‹çš„è‚è…ä»£è¬åŠŸèƒ½å°šæœªç™¼è‚²å®Œå…¨ï¼Œä¸å¯ç›´æ¥æœç”¨æˆäººåŠ‘é‡ï¼</b><br>æˆ‘å€‘æœƒå»ºè­°ä½¿ç”¨è—¥æ°´æˆ–ç²‰åŠ‘ã€‚<br><br>æ¥è‘—è«‹ç¢ºèªï¼š<b>æœ‰ç„¡è—¥ç‰©æˆ–é£Ÿç‰©éæ•å²ï¼Ÿ</b>", 'duck');
            } else {
                addMsg("äº†è§£ã€‚æ¥è‘—è«‹ç¢ºèªï¼š<b>æœ‰ç„¡è—¥ç‰©æˆ–é£Ÿç‰©éæ•å²ï¼Ÿ</b><br>(ä¾‹å¦‚ï¼šå°é˜¿æ–¯åŒ¹éˆã€æµ·é®®éæ•)", 'duck');
            }
            chatStep = 2; // é€²å…¥ä¸‹ä¸€éšæ®µ
        }
        
        else if (chatStep === 2) {
            // æª¢å‚·çµæŸï¼Œçµ¦å‡ºæ–¹æ¡ˆ
            chatStep = 0; // é‡ç½®ç‹€æ…‹
            
            // 1. æ¨è–¦è—¥å“ (Drug) - å¼·èª¿å‰¯ä½œç”¨ & é–€å¸‚å°æµ
            addMsg("æ ¹æ“šæ‚¨çš„ç‹€æ³ï¼Œå¦‚æœæ˜¯è¼•å¾®é ­ç—›ï¼Œè—¥å¸«é€šå¸¸å»ºè­°ä½¿ç”¨ <b>ä¹™é†¯èƒºé…š (Acetaminophen)</b> æˆåˆ†è—¥å“ã€‚", 'duck');
            
            setTimeout(() => {
                const warningHTML = `
                    <div class="warning-box">
                        <b>ğŸ‘¨â€âš•ï¸ è—¥å¸«å°å®åš€ (Side Effects)ï¼š</b><br>
                        æ­¤è—¥å“å¯èƒ½å‚·èƒƒï¼Œå»ºè­°é£¯å¾Œæœç”¨ã€‚24å°æ™‚å…§ä¸å¯éé‡ï¼Œä¸”<b>æœè—¥æœŸé–“ç¦æ­¢é£²é…’</b>ã€‚
                    </div>
                    <div class="action-btn btn-store" onclick="showMap()">
                        ğŸ“ æŸ¥è©¢æœ€è¿‘çš„å¤§æ¨¹é–€å¸‚ (ç¢ºèªåº«å­˜)
                    </div>
                `;
                addMsg(warningHTML, 'duck');
            }, 500);

            // 2. äº¤å‰éŠ·å”®ä¿å¥å“ (Supplement) - å¼·èª¿ç·šä¸Šè³¼è²·
            setTimeout(() => {
                addMsg("å¦å¤–ï¼Œé•·æœŸé ­ç—›æœ‰æ™‚æ˜¯å› ç‚ºå£“åŠ›å¤§æˆ–ç¼ºä¹ç¶­ç”Ÿç´ Bã€‚ğŸ¦†<br>æ‚¨å¯ä»¥åœ¨å¤§æ¨¹ç·šä¸Šè³¼ç‰©ç¶²åƒè€ƒé€™æ¬¾ï¼Œå¹«åŠ©ç¥ç¶“ä¿®å¾©ï¼š", 'duck');
                
                const recHTML = `
                    <div class="card-insert">
                        <img src="images/p_b_complex.jpg" onerror="this.src='https://placehold.co/300x150/e8f5e9/333?text=B-Complex'">
                        <div style="padding:10px;">
                            <b>å¤§æ¨¹ Bç¾¤+éµ (å¢å¼·é«”åŠ›)</b>
                            <div class="action-btn btn-online" onclick="window.open('https://shop.greattree.com.tw')">
                                ğŸ›’ ç·šä¸Šè³¼è²· (æ»¿é¡å…é‹)
                            </div>
                        </div>
                    </div>
                `;
                addMsg(recHTML, 'duck');
                
                // çµæŸäº’å‹•ï¼Œçµ¦é»æ•¸
                triggerLevelUp();
            }, 2000);
        }

        // --- åŠ‡æœ¬ Bï¼šBç¾¤è¡›æ•™æ¢—åœ– (Meme Flow) ---
        else if (text.includes("Bç¾¤") || text.includes("ç¶­ä»–å‘½")) {
            addMsg("å¾ˆå¤šäººææ·· <b>Bç¾¤</b> è·Ÿ <b>ç¶œåˆç¶­ä»–å‘½</b> å‘¢ï¼ğŸ¦†ğŸ’¦<br>è®“æˆ‘ç”¨ä¸€å¼µåœ–å‘Šè¨´ä½ æ€éº¼é¸ï¼š", 'duck');
            
            setTimeout(() => {
                const memeHTML = `
                    <div class="card-insert">
                        <img src="images/meme_b_vit.jpg" onerror="this.src='https://placehold.co/300x200/eee/555?text=Meme:+B-Complex+vs+Multi'">
                    </div>
                    <div style="font-size:13px; color:#666; margin-top:5px; line-height:1.5;">
                        ğŸ’Š <b>Bç¾¤ (æ¶ˆé˜²å“¡)</b>ï¼šé«˜åŠ‘é‡ï¼Œåƒã€Œç‰¹æ•ˆè—¥ã€ï¼Œé©åˆç†¬å¤œã€ç‰¹åˆ¥ç–²å‹æ™‚åƒã€‚<br>
                        ğŸ¥— <b>ç¶œåˆç¶­ä»–å‘½ (è‡ªåŠ©é¤)</b>ï¼šå‡è¡¡ç‡Ÿé¤Šï¼Œåƒã€Œæ—¥å¸¸é£²é£Ÿã€ï¼Œé©åˆå¤©å¤©åƒä¿é¤Šã€‚
                    </div>
                `;
                addMsg(memeHTML, 'duck');
                triggerLevelUp();
            }, 600);
        }

        // --- é è¨­å›æ‡‰ ---
        else {
            addMsg("é´¨é´¨æ­£åœ¨å­¸ç¿’ä¸­... ğŸ¦†<br>æ‚¨å¯ä»¥è©¦è‘—è¼¸å…¥ã€Œ<b>é ­ç—›</b>ã€ä¾†é«”é©—æˆ‘å€‘çš„ã€æª¢å‚·åˆ†é¡æµç¨‹ã€‘ï¼Œæˆ–è¼¸å…¥ã€Œ<b>Bç¾¤</b>ã€çœ‹è¡›æ•™åœ–å–”ï¼", 'duck');
            chatStep = 0;
        }
    }

    // è¼”åŠ©åŠŸèƒ½ï¼šé¡¯ç¤ºè¨Šæ¯
    function addMsg(content, sender) {
        const body = document.getElementById('chatBody');
        body.innerHTML += `<div class="msg msg-${sender}"><div class="bubble">${content}</div></div>`;
        body.scrollTop = body.scrollHeight;
    }

    // è¼”åŠ©åŠŸèƒ½ï¼šé¡¯ç¤ºåœ°åœ– (æ¨¡æ“¬ Store Locator)
    function showMap() {
        addMsg("æ­£åœ¨ç‚ºæ‚¨å®šä½... ğŸ“", 'duck');
        setTimeout(() => {
            const mapHTML = `
                <div class="card-insert">
                    <img src="images/map_demo.jpg" onerror="this.src='https://placehold.co/300x200/a5d6a7/333?text=Map:+GreatTree+Pharmacy'">
                    <div style="padding:10px; font-size:14px;">
                        <b>è·é›¢æœ€è¿‘ï¼šå¤§æ¨¹è—¥å±€ ä»å¾·åº—</b><br>
                        <span style="color:#666;">è·é›¢ 500 å…¬å°º | ç‡Ÿæ¥­ä¸­</span>
                    </div>
                    <div class="action-btn btn-store" onclick="alert('é–‹å•Ÿ Google Maps å°èˆª')">
                        ğŸš€ é–‹å§‹å°èˆª
                    </div>
                </div>
            `;
            addMsg(mapHTML, 'duck');
        }, 800);
    }

    // è¼”åŠ©åŠŸèƒ½ï¼šå‡ç´šå‹•ç•« (Gamification)
    function triggerLevelUp() {
        setTimeout(() => {
            const modal = document.getElementById('levelUpModal');
            modal.style.display = 'block';
            setTimeout(() => { modal.style.display = 'none'; }, 3000);
        }, 3000);
    }
</script>

</body>
</html>