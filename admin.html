<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pharma.Duck ç³»çµ±ç®¡ç†å¾Œå°</title>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: #111827; color: white; margin: 0; padding: 0; height: 100vh; display: flex; flex-direction: column; }
        
        /* é ‚éƒ¨å°èˆª */
        .navbar { background: #1f2937; padding: 15px 30px; border-bottom: 2px solid #F39800; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        h1 { margin: 0; font-size: 20px; color: #F39800; display: flex; align-items: center; gap: 10px; }
        
        /* ä¸»ç‰ˆé¢é…ç½® (å·¦å³åˆ†å‰²) */
        .main-layout { display: flex; flex: 1; overflow: hidden; }
        
        /* å·¦å´ï¼šç·¨è¼¯å€ */
        .editor-panel { flex: 1; padding: 20px; overflow-y: auto; border-right: 1px solid #374151; }
        
        /* å³å´ï¼šé è¦½å€ */
        .preview-panel { width: 400px; background: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; border-left: 5px solid #F39800; background-image: radial-gradient(#333 1px, transparent 1px); background-size: 20px 20px; }
        
        /* æ‰‹æ©Ÿæ¨¡æ“¬å™¨å¤–æ¡† */
        .phone-mockup {
            width: 360px; height: 720px; background: white; border-radius: 30px; 
            border: 8px solid #333; overflow: hidden; position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        .phone-mockup iframe { width: 100%; height: 100%; border: none; }
        
        /* è¡¨æ ¼æ¨£å¼ */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; background: #1f2937; border-radius: 8px; overflow: hidden; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid #374151; font-size: 14px; }
        th { background: #374151; color: #F39800; }
        tr:hover { background: #2d3748; }
        
        input { 
            background: #111827; border: 1px solid #4b5563; color: white; 
            padding: 6px; border-radius: 4px; width: 100%; box-sizing: border-box; 
        }
        input:focus { border-color: #F39800; outline: none; }
        
        /* æŒ‰éˆ•æ¨£å¼ */
        .btn { border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: bold; transition: 0.2s; }
        .btn-preview { background: #3b82f6; color: white; }
        .btn-preview:hover { background: #2563eb; }
        .btn-save { background: #009944; color: white; padding: 10px 25px; font-size: 16px; border-radius: 20px; }
        .btn-reset { background: #ef4444; color: white; }

        .action-bar { margin-top: 20px; display: flex; justify-content: space-between; align-items: center; }
        .status-msg { color: #10b981; opacity: 0; transition: opacity 0.5s; font-weight: bold; }
    </style>
</head>
<body>

<div class="navbar">
    <h1>ğŸ¦† å¾Œå°ç®¡ç†ç³»çµ± <span style="font-size:12px; color:#9ca3af; margin-left:10px;">(æ‰€æœ‰æ›´å‹•å³æ™‚ç”Ÿæ•ˆ)</span></h1>
    <button class="btn btn-reset" onclick="resetToDefault()">â†º æ¢å¾©åŸå» è¨­å®š</button>
</div>

<div class="main-layout">
    
    <div class="editor-panel">
        <h3 style="margin-top:0;">ç­‰ç´šæ•¸å€¼é…ç½®</h3>
        <table>
            <thead>
                <tr>
                    <th width="50">Lv</th>
                    <th>ç¨±è™Ÿ (Name)</th>
                    <th width="100">EXP é–€æª»</th>
                    <th>åœ–ç‰‡è·¯å¾‘</th>
                    <th width="60">æ“ä½œ</th>
                </tr>
            </thead>
            <tbody id="configTable">
                </tbody>
        </table>

        <div class="action-bar">
            <span class="status-msg" id="msg">âœ… è¨­å®šå·²ä¿å­˜ï¼</span>
            <button class="btn btn-save" onclick="saveConfig()">ğŸ’¾ ä¿å­˜ä¸¦å¥—ç”¨è¨­å®š</button>
        </div>
        
        <div style="margin-top:30px; padding:15px; background:#374151; border-radius:8px; font-size:13px; color:#ccc;">
            <strong>ğŸ’¡ ä½¿ç”¨èªªæ˜ï¼š</strong><br>
            1. ä¿®æ”¹æ•¸å€¼å¾Œï¼Œè«‹å…ˆæŒ‰ <b>[ä¿å­˜]</b>ã€‚<br>
            2. é»æ“Šåˆ—è¡¨å³å´çš„ <b>[ğŸ‘ï¸ é è¦½]</b> æŒ‰éˆ•ã€‚<br>
            3. å³å´æ‰‹æ©Ÿç•«é¢æœƒç›´æ¥æ¨¡æ“¬è©²ç­‰ç´šçš„æœƒå“¡ä»‹é¢ã€‚<br>
            (æ³¨æ„ï¼šé è¦½åŠŸèƒ½æœƒæš«æ™‚ä¿®æ”¹æ‚¨çš„ç€è¦½å™¨ç´€éŒ„ï¼Œå°‡æ‚¨çš„èº«ä»½åˆ‡æ›ç‚ºè©²ç­‰ç´š)
        </div>
    </div>

    <div class="preview-panel">
        <div style="color:white; margin-bottom:10px; font-weight:bold;">ğŸ“± æœƒå“¡ä¸­å¿ƒå³æ™‚é è¦½</div>
        <div class="phone-mockup">
            <iframe id="previewFrame" src="member.html"></iframe>
        </div>
    </div>

</div>

<script>
    // 1. åŸå» é è¨­å€¼
    const defaultConfig = [
        { lv: 1, name: "ç ´æ®¼è¦‹ç¿’ç”Ÿ", minExp: 0, img: "images/duck_lv1.png" },
        { lv: 2, name: "å¥½å¥‡æ¢éšªé´¨", minExp: 500, img: "images/duck_lv2.png" },
        { lv: 3, name: "å¥åº·å°å¹«æ‰‹", minExp: 3000, img: "images/duck_lv3.png" },
        { lv: 4, name: "åˆéšæŠ«è¢é´¨", minExp: 10000, img: "images/duck_lv4.png" },
        { lv: 5, name: "èª¿åŠ‘ç†Ÿæ‰‹é´¨", minExp: 25000, img: "images/duck_lv5.png" },
        { lv: 6, name: "è¡›æ•™é ˜èˆªå“¡", minExp: 50000, img: "images/duck_lv6.png" },
        { lv: 7, name: "è³‡æ·±è—¥å¸«é´¨", minExp: 100000, img: "images/duck_lv7.png" },
        { lv: 8, name: "å¤§æ¨¹åº—é•·é´¨", minExp: 250000, img: "images/duck_lv8.png" },
        { lv: 9, name: "æ¦®è­½é•·è€é´¨", minExp: 500000, img: "images/duck_lv9.png" },
        { lv: 10, name: "é†«è—¥å®ˆè­·ç¥", minExp: 1000000, img: "images/duck_lv10.png" }
    ];

    let currentConfig = [];

    // 2. åˆå§‹åŒ–
    function init() {
        const saved = localStorage.getItem('customLevelConfig');
        currentConfig = saved ? JSON.parse(saved) : JSON.parse(JSON.stringify(defaultConfig));
        renderTable();
    }

    // 3. æ¸²æŸ“è¡¨æ ¼
    function renderTable() {
        const tbody = document.getElementById('configTable');
        tbody.innerHTML = '';

        currentConfig.forEach((item, index) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td style="font-weight:bold; color:#F39800;">${item.lv}</td>
                <td><input type="text" value="${item.name}" onchange="updateItem(${index}, 'name', this.value)"></td>
                <td><input type="number" value="${item.minExp}" onchange="updateItem(${index}, 'minExp', this.value)"></td>
                <td><input type="text" value="${item.img}" onchange="updateItem(${index}, 'img', this.value)"></td>
                <td>
                    <button class="btn btn-preview" onclick="previewLevel(${index})">ğŸ‘ï¸ é è¦½</button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }

    function updateItem(index, field, value) {
        if (field === 'minExp') value = parseInt(value);
        currentConfig[index][field] = value;
    }

    // 4. ä¿å­˜è¨­å®š
    function saveConfig() {
        localStorage.setItem('customLevelConfig', JSON.stringify(currentConfig));
        
        // é¡¯ç¤ºæˆåŠŸè¨Šæ¯
        const msg = document.getElementById('msg');
        msg.style.opacity = '1';
        setTimeout(() => msg.style.opacity = '0', 3000);
        
        // é‡æ–°æ•´ç† iframe è®“è¨­å®šç”Ÿæ•ˆ
        document.getElementById('previewFrame').contentWindow.location.reload();
    }

    // 5. æ ¸å¿ƒåŠŸèƒ½ï¼šé è¦½æŒ‡å®šç­‰ç´š
    function previewLevel(index) {
        const targetLevel = currentConfig[index];
        
        // æˆ‘å€‘è¦ã€Œå½é€ ã€ä¸€å€‹ä½¿ç”¨è€…æ•¸æ“šï¼Œå­˜å…¥ localStorage
        // é€™æ¨£å³é‚Šçš„ iframe (member.html) è®€å–æ™‚ï¼Œå°±æœƒä»¥ç‚ºä½¿ç”¨è€…æ˜¯é€™å€‹ç­‰ç´š
        const mockUser = {
            level: targetLevel.lv,
            exp: targetLevel.minExp, // æŠŠç¶“é©—å€¼è¨­ç‚ºè©²ç­‰ç´šå‰›å¥½çš„é–€æª»
            coins: 9999, // çµ¦å¤šä¸€é»éŒ¢æ–¹ä¾¿æ¸¬è©¦
            currentSkin: targetLevel.img, // ç©¿ä¸Šè©²ç­‰ç´šçš„è¡£æœ
            unlockedSkins: [targetLevel.img],
            lastSeason: "2026-S1" // é¿å…è¢«è³½å­£é‡ç½®æ­¸é›¶
        };

        // å­˜å…¥ç€è¦½å™¨
        localStorage.setItem('duckUser', JSON.stringify(mockUser));
        
        // å¼·åˆ¶é‡æ–°æ•´ç† iframe
        document.getElementById('previewFrame').contentWindow.location.reload();
        
        // æç¤ºä½¿ç”¨è€…
        // alert(`å·²åˆ‡æ›é è¦½è¦–è§’ç‚ºï¼šLv.${targetLevel.lv} ${targetLevel.name}`);
    }

    // 6. é‡ç½®åŠŸèƒ½
    function resetToDefault() {
        if(confirm("ç¢ºå®šè¦æ¢å¾©åŸå» è¨­å®šå—ï¼Ÿ")) {
            localStorage.removeItem('customLevelConfig');
            init(); 
            document.getElementById('previewFrame').contentWindow.location.reload();
        }
    }

    init();
</script>

</body>
</html>
